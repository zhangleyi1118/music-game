# 音乐游戏改造项目

## 项目概述
这个项目将原有的3D角色控制游戏改造为音乐节奏游戏。玩家需要在背景音乐的节拍中跳跃到对应的方块上获取积分，同时避开飘过的五线谱线。

## 主要功能

### 1. 音乐和节拍系统
- 背景音乐播放
- 节拍检测和计时
- 节奏精度计算

### 2. 积分系统
- 方块命中积分
- 连击系统
- 节奏精度奖励

### 3. 血量系统
- 五线谱碰触伤害
- 血条显示
- 游戏结束判定

### 4. 音效系统
- 跳跃音效
- 攀爬音效
- 脚步音效
- 方块命中音效

### 5. 游戏界面
- 分数显示
- 连击计数
- 血条显示
- 游戏结束界面

## 使用说明

### 场景设置
1. 将 `MusicGameManager` 添加到场景中
2. 设置背景音乐和BPM
3. 添加 `CubeSpawner` 和 `StaffLineSpawner`
4. 设置玩家生成点

### 方块设置
1. 创建方块预制体
2. 添加 `CubeController` 组件
3. 设置方块类型和分数

### 五线谱设置
1. 创建五线谱预制体
2. 添加 `StaffLineController` 组件
3. 设置移动速度和伤害值

### 音效设置
1. 准备各种音效文件
2. 在 `MusicGameManager` 中设置音效引用

## 核心脚本说明

### MusicGameManager
游戏核心管理器，控制音乐播放、节拍计时、分数计算和游戏状态。

### CubeController
方块控制器，处理玩家碰撞、分数计算和节奏精度检测。

### StaffLineController
五线谱控制器，处理移动逻辑和玩家伤害。

### CubeSpawner
方块生成器，根据节拍或定时器生成方块。

### StaffLineSpawner
五线谱生成器，根据节拍模式生成五线谱。

### PlayerSoundIntegration
玩家音效集成器，连接现有玩家状态机与音乐游戏音效系统。

## 扩展建议

1. **视觉效果**：添加方块命中特效、连击特效
2. **难度系统**：根据游戏进度调整BPM和生成频率
3. **多种音乐**：添加多个关卡和音乐
4. **排行榜**：在线分数排行榜
5. **教学模式**：新手引导和教程

## 注意事项

- 确保所有预制体都有正确的标签设置
- 调整BPM和生成频率以获得最佳游戏体验
- 测试不同音效的协调性